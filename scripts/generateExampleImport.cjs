/**
 * Generates an example Excel file for bulk importing books.
 * Usage: node scripts/generateExampleImport.cjs
 */

const XLSX = require('xlsx');
const path = require('path');

const rows = [
  {
    'מספר מזהה': '001',
    'שם הספר': 'דיונה',
    'מחבר - שם פרטי': 'פרנק',
    'מחבר - שם משפחה': 'הרברט',
    'ז׳אנרים': 'מד"ע',
    'תת-ז׳אנרים': '',
    'ISBN': '978-965-07-1234-5',
    'שנת הוצאה': 1965,
    'הוצאה לאור': 'כנרת',
    'מהדורה': 'ראשונה',
    'שפה': 'עברית',
    'שם מקורי': 'Dune',
    'שפה מקורית': 'אנגלית',
    'מתורגם ע״י': 'יוסי לב',
    'שנת תרגום': 1990,
    'מספר עמודים': 620,
    'שם סדרה': 'דיונה',
    'מספר כרך': 1,
    'חלק בכרך': '',
    'סה״כ כרכים': 6,
    'כרכים לא מתורגמים': 'כן',
    'הערות': 'קלאסיקת מד"ע',
    'מיקום פיזי': 'מדף 3',
    'סטטוס קריאה': 'read',
    'דירוג': 5,
  },
  {
    'מספר מזהה': '002',
    'שם הספר': 'שלטון הטבעות: אחוות הטבעת',
    'מחבר - שם פרטי': 'ג׳.ר.ר.',
    'מחבר - שם משפחה': 'טולקין',
    'ז׳אנרים': 'פנטזיה',
    'תת-ז׳אנרים': '',
    'ISBN': '978-965-07-5678-9',
    'שנת הוצאה': 1954,
    'הוצאה לאור': 'זמורה ביתן',
    'מהדורה': 'שנייה',
    'שפה': 'עברית',
    'שם מקורי': 'The Fellowship of the Ring',
    'שפה מקורית': 'אנגלית',
    'מתורגם ע״י': 'רות לבנית',
    'שנת תרגום': 2001,
    'מספר עמודים': 480,
    'שם סדרה': 'שלטון הטבעות',
    'מספר כרך': 1,
    'חלק בכרך': '',
    'סה״כ כרכים': 3,
    'כרכים לא מתורגמים': 'לא',
    'הערות': '',
    'מיקום פיזי': 'מדף 2',
    'סטטוס קריאה': 'read',
    'דירוג': 5,
  },
  {
    'מספר מזהה': '003',
    'שם הספר': 'הזקן והים',
    'מחבר - שם פרטי': 'ארנסט',
    'מחבר - שם משפחה': 'המינגוויי',
    'ז׳אנרים': 'רומן',
    'תת-ז׳אנרים': '',
    'ISBN': '978-965-07-2345-6',
    'שנת הוצאה': 1952,
    'הוצאה לאור': 'עם עובד',
    'מהדורה': '',
    'שפה': 'עברית',
    'שם מקורי': 'The Old Man and the Sea',
    'שפה מקורית': 'אנגלית',
    'מתורגם ע״י': 'אהרן אמיר',
    'שנת תרגום': 1970,
    'מספר עמודים': 127,
    'שם סדרה': '',
    'מספר כרך': '',
    'חלק בכרך': '',
    'סה״כ כרכים': '',
    'כרכים לא מתורגמים': '',
    'הערות': 'נובלה קצרה',
    'מיקום פיזי': 'מדף 1',
    'סטטוס קריאה': 'read',
    'דירוג': 4,
  },
  {
    'מספר מזהה': '004',
    'שם הספר': 'המשחק של אנדר',
    'מחבר - שם פרטי': 'אורסון סקוט',
    'מחבר - שם משפחה': 'קארד',
    'ז׳אנרים': 'מד"ע',
    'תת-ז׳אנרים': 'צעירים',
    'ISBN': '',
    'שנת הוצאה': 1985,
    'הוצאה לאור': 'מודן',
    'מהדורה': '',
    'שפה': 'עברית',
    'שם מקורי': "Ender's Game",
    'שפה מקורית': 'אנגלית',
    'מתורגם ע״י': 'אילנה רמון',
    'שנת תרגום': 2005,
    'מספר עמודים': 380,
    'שם סדרה': 'המשחק של אנדר',
    'מספר כרך': 1,
    'חלק בכרך': '',
    'סה״כ כרכים': 5,
    'כרכים לא מתורגמים': 'כן',
    'הערות': '',
    'מיקום פיזי': 'מדף 3',
    'סטטוס קריאה': 'unread',
    'דירוג': '',
  },
  {
    'מספר מזהה': '005',
    'שם הספר': 'שומר הסודות',
    'מחבר - שם פרטי': 'דן;ג׳ון',
    'מחבר - שם משפחה': 'בראון;סמית',
    'ז׳אנרים': 'מותחן;רומן',
    'תת-ז׳אנרים': 'אימה',
    'ISBN': '978-965-07-9999-0',
    'שנת הוצאה': 2010,
    'הוצאה לאור': 'כתר',
    'מהדורה': 'ראשונה',
    'שפה': 'עברית',
    'שם מקורי': '',
    'שפה מקורית': '',
    'מתורגם ע״י': '',
    'שנת תרגום': '',
    'מספר עמודים': 350,
    'שם סדרה': '',
    'מספר כרך': '',
    'חלק בכרך': '',
    'סה״כ כרכים': '',
    'כרכים לא מתורגמים': '',
    'הערות': 'דוגמה עם שני מחברים ושני ז׳אנרים (מופרדים ב-;)',
    'מיקום פיזי': 'מדף 5',
    'סטטוס קריאה': 'reading',
    'דירוג': 3,
  },
];

const ws = XLSX.utils.json_to_sheet(rows);

// Set column widths for readability
ws['!cols'] = [
  { wch: 12 }, // מספר מזהה
  { wch: 30 }, // שם הספר
  { wch: 15 }, // מחבר - שם פרטי
  { wch: 15 }, // מחבר - שם משפחה
  { wch: 15 }, // ז׳אנרים
  { wch: 12 }, // תת-ז׳אנרים
  { wch: 20 }, // ISBN
  { wch: 10 }, // שנת הוצאה
  { wch: 15 }, // הוצאה לאור
  { wch: 10 }, // מהדורה
  { wch: 10 }, // שפה
  { wch: 30 }, // שם מקורי
  { wch: 12 }, // שפה מקורית
  { wch: 15 }, // מתורגם ע״י
  { wch: 10 }, // שנת תרגום
  { wch: 12 }, // מספר עמודים
  { wch: 20 }, // שם סדרה
  { wch: 10 }, // מספר כרך
  { wch: 10 }, // חלק בכרך
  { wch: 12 }, // סה״כ כרכים
  { wch: 18 }, // כרכים לא מתורגמים
  { wch: 40 }, // הערות
  { wch: 12 }, // מיקום פיזי
  { wch: 12 }, // סטטוס קריאה
  { wch: 8 },  // דירוג
];

const wb = XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb, ws, 'ספרים');

const outPath = path.join(__dirname, '..', 'import-example.xlsx');
XLSX.writeFile(wb, outPath);
console.log(`✅ Example file created: ${outPath}`);
